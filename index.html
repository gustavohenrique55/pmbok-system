<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gestão de Projetos - PMBOK 7ª Edição</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const PMBOKProjectManager = () => {
            // Estados principais
            const [activeView, setActiveView] = useState('dashboard');
            const [projects, setProjects] = useState([]);
            const [activeProject, setActiveProject] = useState(null);
            const [showModal, setShowModal] = useState(null);
            const [editingItem, setEditingItem] = useState(null);

            // Estados para diferentes artefatos do PMBOK
            const [projectCharters, setProjectCharters] = useState([]);
            const [stakeholders, setStakeholders] = useState([]);
            const [risks, setRisks] = useState([]);
            const [wbs, setWbs] = useState([]);
            const [changes, setChanges] = useState([]);
            const [lessons, setLessons] = useState([]);
            const [deliverables, setDeliverables] = useState([]);
            const [qualityMetrics, setQualityMetrics] = useState([]);
            const [communications, setCommunications] = useState([]);
            const [resources, setResources] = useState([]);

            // Carregar dados do localStorage
            useEffect(() => {
                const loadData = (key, setter) => {
                    const data = localStorage.getItem(key);
                    if (data) setter(JSON.parse(data));
                };
                
                loadData('pmbok_projects', setProjects);
                loadData('pmbok_charters', setProjectCharters);
                loadData('pmbok_stakeholders', setStakeholders);
                loadData('pmbok_risks', setRisks);
                loadData('pmbok_wbs', setWbs);
                loadData('pmbok_changes', setChanges);
                loadData('pmbok_lessons', setLessons);
                loadData('pmbok_deliverables', setDeliverables);
                loadData('pmbok_quality', setQualityMetrics);
                loadData('pmbok_communications', setCommunications);
                loadData('pmbok_resources', setResources);
            }, []);

            // Salvar dados no localStorage
            useEffect(() => {
                localStorage.setItem('pmbok_projects', JSON.stringify(projects));
            }, [projects]);

            useEffect(() => {
                localStorage.setItem('pmbok_charters', JSON.stringify(projectCharters));
            }, [projectCharters]);

            useEffect(() => {
                localStorage.setItem('pmbok_stakeholders', JSON.stringify(stakeholders));
            }, [stakeholders]);

            useEffect(() => {
                localStorage.setItem('pmbok_risks', JSON.stringify(risks));
            }, [risks]);

            useEffect(() => {
                localStorage.setItem('pmbok_wbs', JSON.stringify(wbs));
            }, [wbs]);

            useEffect(() => {
                localStorage.setItem('pmbok_changes', JSON.stringify(changes));
            }, [changes]);

            useEffect(() => {
                localStorage.setItem('pmbok_lessons', JSON.stringify(lessons));
            }, [lessons]);

            useEffect(() => {
                localStorage.setItem('pmbok_deliverables', JSON.stringify(deliverables));
            }, [deliverables]);

            useEffect(() => {
                localStorage.setItem('pmbok_quality', JSON.stringify(qualityMetrics));
            }, [qualityMetrics]);

            useEffect(() => {
                localStorage.setItem('pmbok_communications', JSON.stringify(communications));
            }, [communications]);

            useEffect(() => {
                localStorage.setItem('pmbok_resources', JSON.stringify(resources));
            }, [resources]);

            // Os 12 Princípios do PMBOK 7
            const pmbokPrinciples = [
                { id: 1, name: "Administração", icon: "shield", description: "Ser um administrador diligente, respeitoso e atencioso" },
                { id: 2, name: "Colaboração", icon: "users", description: "Criar um ambiente colaborativo da equipe do projeto" },
                { id: 3, name: "Stakeholders", icon: "user-check", description: "Engajar-se efetivamente com as partes interessadas" },
                { id: 4, name: "Valor", icon: "target", description: "Focar no valor" },
                { id: 5, name: "Pensamento Sistêmico", icon: "git-branch", description: "Reconhecer e responder às interações do sistema" },
                { id: 6, name: "Liderança", icon: "award", description: "Demonstrar comportamentos de liderança" },
                { id: 7, name: "Adaptação", icon: "refresh-cw", description: "Adaptar com base no contexto" },
                { id: 8, name: "Qualidade", icon: "check-circle", description: "Incorporar qualidade nos processos e entregas" },
                { id: 9, name: "Complexidade", icon: "layers", description: "Navegar na complexidade" },
                { id: 10, name: "Riscos", icon: "alert-triangle", description: "Otimizar respostas aos riscos" },
                { id: 11, name: "Resiliência", icon: "activity", description: "Abraçar adaptabilidade e resiliência" },
                { id: 12, name: "Mudança", icon: "trending-up", description: "Permitir mudanças para alcançar o estado futuro" }
            ];

            // Os 8 Domínios de Desempenho do PMBOK 7
            const performanceDomains = [
                { id: 'stakeholders', name: 'Partes Interessadas', icon: 'users', color: 'bg-blue-500' },
                { id: 'team', name: 'Equipe', icon: 'user-plus', color: 'bg-green-500' },
                { id: 'development', name: 'Desenvolvimento e Ciclo de Vida', icon: 'git-branch', color: 'bg-purple-500' },
                { id: 'planning', name: 'Planejamento', icon: 'calendar', color: 'bg-indigo-500' },
                { id: 'project-work', name: 'Trabalho do Projeto', icon: 'briefcase', color: 'bg-yellow-500' },
                { id: 'delivery', name: 'Entrega', icon: 'package', color: 'bg-red-500' },
                { id: 'measurement', name: 'Medição', icon: 'bar-chart-2', color: 'bg-pink-500' },
                { id: 'uncertainty', name: 'Incerteza', icon: 'alert-triangle', color: 'bg-orange-500' }
            ];

            // Menu lateral de navegação
            const menuItems = [
                { id: 'dashboard', name: 'Dashboard', icon: 'layout-dashboard' },
                { id: 'charter', name: 'Project Charter', icon: 'file-text' },
                { id: 'stakeholders', name: 'Stakeholders', icon: 'users' },
                { id: 'wbs', name: 'EAP/WBS', icon: 'git-branch' },
                { id: 'schedule', name: 'Cronograma', icon: 'calendar' },
                { id: 'resources', name: 'Recursos', icon: 'user-plus' },
                { id: 'risks', name: 'Riscos', icon: 'alert-triangle' },
                { id: 'quality', name: 'Qualidade', icon: 'check-circle' },
                { id: 'communications', name: 'Comunicações', icon: 'message-circle' },
                { id: 'changes', name: 'Mudanças', icon: 'refresh-cw' },
                { id: 'deliverables', name: 'Entregas', icon: 'package' },
                { id: 'metrics', name: 'Métricas/EVA', icon: 'bar-chart-2' },
                { id: 'lessons', name: 'Lições Aprendidas', icon: 'book-open' }
            ];

            // Componente Dashboard
            const Dashboard = () => {
                const canvasRefs = {
                    eva: useRef(null),
                    risks: useRef(null),
                    performance: useRef(null)
                };

                const chartInstances = useRef({});

                useEffect(() => {
                    // Destruir gráficos anteriores
                    Object.values(chartInstances.current).forEach(chart => {
                        if (chart) chart.destroy();
                    });

                    if (activeProject) {
                        // Gráfico EVA (Earned Value Analysis)
                        if (canvasRefs.eva.current) {
                            const ctx = canvasRefs.eva.current.getContext('2d');
                            chartInstances.current.eva = new Chart(ctx, {
                                type: 'line',
                                data: {
                                    labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
                                    datasets: [
                                        {
                                            label: 'Valor Planejado (PV)',
                                            data: [10000, 20000, 35000, 50000, 65000, 80000],
                                            borderColor: 'rgb(59, 130, 246)',
                                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                            tension: 0.1
                                        },
                                        {
                                            label: 'Valor Agregado (EV)',
                                            data: [8000, 18000, 30000, 42000, 55000, 68000],
                                            borderColor: 'rgb(34, 197, 94)',
                                            backgroundColor: 'rgba(34, 197, 94, 0.1)',
                                            tension: 0.1
                                        },
                                        {
                                            label: 'Custo Real (AC)',
                                            data: [9000, 19000, 32000, 45000, 58000, 72000],
                                            borderColor: 'rgb(239, 68, 68)',
                                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                                            tension: 0.1
                                        }
                                    ]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: {
                                        legend: {
                                            position: 'top',
                                        },
                                        title: {
                                            display: true,
                                            text: 'Análise de Valor Agregado (EVA)'
                                        }
                                    }
                                }
                            });
                        }

                        // Gráfico de Riscos
                        if (canvasRefs.risks.current) {
                            const projectRisks = risks.filter(r => r.projectId === activeProject.id);
                            const risksByStatus = {
                                'Alto': projectRisks.filter(r => r.impact === 'high').length,
                                'Médio': projectRisks.filter(r => r.impact === 'medium').length,
                                'Baixo': projectRisks.filter(r => r.impact === 'low').length
                            };

                            const ctx = canvasRefs.risks.current.getContext('2d');
                            chartInstances.current.risks = new Chart(ctx, {
                                type: 'doughnut',
                                data: {
                                    labels: Object.keys(risksByStatus),
                                    datasets: [{
                                        data: Object.values(risksByStatus),
                                        backgroundColor: [
                                            'rgba(239, 68, 68, 0.8)',
                                            'rgba(251, 191, 36, 0.8)',
                                            'rgba(34, 197, 94, 0.8)'
                                        ]
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    plugins: {
                                        legend: {
                                            position: 'bottom',
                                        },
                                        title: {
                                            display: true,
                                            text: 'Distribuição de Riscos'
                                        }
                                    }
                                }
                            });
                        }

                        // Gráfico de Performance dos Domínios
                        if (canvasRefs.performance.current) {
                            const ctx = canvasRefs.performance.current.getContext('2d');
                            chartInstances.current.performance = new Chart(ctx, {
                                type: 'radar',
                                data: {
                                    labels: performanceDomains.map(d => d.name),
                                    datasets: [{
                                        label: 'Performance Atual',
                                        data: [85, 70, 60, 80, 75, 90, 65, 70],
                                        borderColor: 'rgb(59, 130, 246)',
                                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                                    }]
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: false,
                                    scales: {
                                        r: {
                                            beginAtZero: true,
                                            max: 100
                                        }
                                    },
                                    plugins: {
                                        title: {
                                            display: true,
                                            text: 'Performance por Domínio PMBOK'
                                        }
                                    }
                                }
                            });
                        }
                    }

                    return () => {
                        Object.values(chartInstances.current).forEach(chart => {
                            if (chart) chart.destroy();
                        });
                    };
                }, [activeProject, risks]);

                if (!activeProject) {
                    return (
                        <div className="flex items-center justify-center h-full">
                            <div className="text-center">
                                <i data-lucide="folder-open" className="w-16 h-16 text-gray-300 mx-auto mb-4"></i>
                                <h3 className="text-lg font-medium text-gray-900 mb-2">Nenhum projeto selecionado</h3>
                                <p className="text-gray-500">Selecione ou crie um projeto para começar</p>
                            </div>
                        </div>
                    );
                }

                // Calcular métricas do projeto
                const projectRisks = risks.filter(r => r.projectId === activeProject.id);
                const projectStakeholders = stakeholders.filter(s => s.projectId === activeProject.id);
                const projectDeliverables = deliverables.filter(d => d.projectId === activeProject.id);
                const projectChanges = changes.filter(c => c.projectId === activeProject.id);

                const metrics = {
                    cpi: 0.94, // Cost Performance Index
                    spi: 0.88, // Schedule Performance Index
                    risksOpen: projectRisks.filter(r => r.status === 'open').length,
                    deliverablesPending: projectDeliverables.filter(d => d.status !== 'completed').length,
                    changesPending: projectChanges.filter(c => c.status === 'pending').length,
                    stakeholdersEngaged: projectStakeholders.filter(s => s.engagement === 'high').length
                };

                return (
                    <div className="space-y-6">
                        {/* Header do Projeto */}
                        <div className="bg-white rounded-lg shadow p-6">
                            <div className="flex items-start justify-between">
                                <div>
                                    <h2 className="text-2xl font-bold text-gray-900">{activeProject.name}</h2>
                                    <p className="text-gray-600 mt-1">{activeProject.description}</p>
                                    <div className="flex items-center gap-4 mt-4">
                                        <span className="text-sm text-gray-500">
                                            Início: {activeProject.startDate || 'Não definido'}
                                        </span>
                                        <span className="text-sm text-gray-500">
                                            Fim: {activeProject.endDate || 'Não definido'}
                                        </span>
                                        <span className="text-sm text-gray-500">
                                            Orçamento: {activeProject.budget || 'Não definido'}
                                        </span>
                                    </div>
                                </div>
                                <div className="flex items-center gap-2">
                                    <span className={`px-3 py-1 rounded-full text-sm ${
                                        activeProject.status === 'active' ? 'bg-green-100 text-green-800' :
                                        activeProject.status === 'planning' ? 'bg-blue-100 text-blue-800' :
                                        activeProject.status === 'on-hold' ? 'bg-yellow-100 text-yellow-800' :
                                        'bg-gray-100 text-gray-800'
                                    }`}>
                                        {activeProject.status === 'active' ? 'Ativo' :
                                         activeProject.status === 'planning' ? 'Planejamento' :
                                         activeProject.status === 'on-hold' ? 'Pausado' :
                                         'Concluído'}
                                    </span>
                                </div>
                            </div>
                        </div>

                        {/* KPIs Principais */}
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-6 gap-4">
                            <div className="bg-white rounded-lg shadow p-4">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <p className="text-sm text-gray-500">CPI</p>
                                        <p className="text-2xl font-bold text-gray-900">{metrics.cpi}</p>
                                    </div>
                                    <i data-lucide="dollar-sign" className={`w-8 h-8 ${metrics.cpi >= 1 ? 'text-green-500' : 'text-red-500'}`}></i>
                                </div>
                                <p className="text-xs text-gray-500 mt-2">Índice de Desempenho de Custo</p>
                            </div>
                            <div className="bg-white rounded-lg shadow p-4">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <p className="text-sm text-gray-500">SPI</p>
                                        <p className="text-2xl font-bold text-gray-900">{metrics.spi}</p>
                                    </div>
                                    <i data-lucide="clock" className={`w-8 h-8 ${metrics.spi >= 1 ? 'text-green-500' : 'text-red-500'}`}></i>
                                </div>
                                <p className="text-xs text-gray-500 mt-2">Índice de Desempenho de Prazo</p>
                            </div>
                            <div className="bg-white rounded-lg shadow p-4">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <p className="text-sm text-gray-500">Riscos Abertos</p>
                                        <p className="text-2xl font-bold text-gray-900">{metrics.risksOpen}</p>
                                    </div>
                                    <i data-lucide="alert-triangle" className="w-8 h-8 text-orange-500"></i>
                                </div>
                                <p className="text-xs text-gray-500 mt-2">Necessitam atenção</p>
                            </div>
                            <div className="bg-white rounded-lg shadow p-4">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <p className="text-sm text-gray-500">Entregas</p>
                                        <p className="text-2xl font-bold text-gray-900">{metrics.deliverablesPending}</p>
                                    </div>
                                    <i data-lucide="package" className="w-8 h-8 text-blue-500"></i>
                                </div>
                                <p className="text-xs text-gray-500 mt-2">Pendentes</p>
                            </div>
                            <div className="bg-white rounded-lg shadow p-4">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <p className="text-sm text-gray-500">Mudanças</p>
                                        <p className="text-2xl font-bold text-gray-900">{metrics.changesPending}</p>
                                    </div>
                                    <i data-lucide="refresh-cw" className="w-8 h-8 text-purple-500"></i>
                                </div>
                                <p className="text-xs text-gray-500 mt-2">Aguardando aprovação</p>
                            </div>
                            <div className="bg-white rounded-lg shadow p-4">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <p className="text-sm text-gray-500">Stakeholders</p>
                                        <p className="text-2xl font-bold text-gray-900">{metrics.stakeholdersEngaged}</p>
                                    </div>
                                    <i data-lucide="users" className="w-8 h-8 text-green-500"></i>
                                </div>
                                <p className="text-xs text-gray-500 mt-2">Alto engajamento</p>
                            </div>
                        </div>

                        {/* Gráficos */}
                        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <div className="bg-white rounded-lg shadow p-6">
                                <div className="h-64">
                                    <canvas ref={canvasRefs.eva}></canvas>
                                </div>
                            </div>
                            <div className="bg-white rounded-lg shadow p-6">
                                <div className="h-64">
                                    <canvas ref={canvasRefs.risks}></canvas>
                                </div>
                            </div>
                        </div>

                        {/* Performance por Domínio */}
                        <div className="bg-white rounded-lg shadow p-6">
                            <div className="h-80">
                                <canvas ref={canvasRefs.performance}></canvas>
                            </div>
                        </div>

                        {/* Os 12 Princípios */}
                        <div className="bg-white rounded-lg shadow p-6">
                            <h3 className="text-lg font-semibold mb-4">Os 12 Princípios do PMBOK 7</h3>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                {pmbokPrinciples.map(principle => (
                                    <div key={principle.id} className="flex items-start space-x-3 p-3 border rounded-lg hover:bg-gray-50">
                                        <i data-lucide={principle.icon} className="w-5 h-5 text-blue-500 mt-0.5"></i>
                                        <div>
                                            <h4 className="font-medium text-sm">{principle.name}</h4>
                                            <p className="text-xs text-gray-500 mt-1">{principle.description}</p>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            };

            // Componente Project Charter
            const ProjectCharter = () => {
                const projectCharter = projectCharters.find(c => c.projectId === activeProject?.id);

                const handleSaveCharter = (charter) => {
                    if (projectCharter) {
                        setProjectCharters(projectCharters.map(c => 
                            c.projectId === activeProject.id ? charter : c
                        ));
                    } else {
                        setProjectCharters([...projectCharters, charter]);
                    }
                    setShowModal(null);
                };

                return (
                    <div className="space-y-6">
                        <div className="bg-white rounded-lg shadow p-6">
                            <div className="flex items-center justify-between mb-6">
                                <h2 className="text-2xl font-bold text-gray-900">Project Charter</h2>
                                <button
                                    onClick={() => setShowModal('charter')}
                                    className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center gap-2"
                                >
                                    <i data-lucide={projectCharter ? 'edit' : 'plus'} className="w-4 h-4"></i>
                                    {projectCharter ? 'Editar Charter' : 'Criar Charter'}
                                </button>
                            </div>

                            {projectCharter ? (
                                <div className="space-y-4">
                                    <div className="border-l-4 border-blue-500 pl-4">
                                        <h3 className="font-semibold text-gray-700">Justificativa do Projeto</h3>
                                        <p className="text-gray-600 mt-1">{projectCharter.justification}</p>
                                    </div>
                                    <div className="border-l-4 border-green-500 pl-4">
                                        <h3 className="font-semibold text-gray-700">Objetivos</h3>
                                        <p className="text-gray-600 mt-1">{projectCharter.objectives}</p>
                                    </div>
                                    <div className="border-l-4 border-yellow-500 pl-4">
                                        <h3 className="font-semibold text-gray-700">Escopo de Alto Nível</h3>
                                        <p className="text-gray-600 mt-1">{projectCharter.highLevelScope}</p>
                                    </div>
                                    <div className="border-l-4 border-purple-500 pl-4">
                                        <h3 className="font-semibold text-gray-700">Principais Entregas</h3>
                                        <p className="text-gray-600 mt-1">{projectCharter.keyDeliverables}</p>
                                    </div>
                                    <div className="border-l-4 border-red-500 pl-4">
                                        <h3 className="font-semibold text-gray-700">Riscos de Alto Nível</h3>
                                        <p className="text-gray-600 mt-1">{projectCharter.highLevelRisks}</p>
                                    </div>
                                    <div className="border-l-4 border-indigo-500 pl-4">
                                        <h3 className="font-semibold text-gray-700">Premissas e Restrições</h3>
                                        <p className="text-gray-600 mt-1">{projectCharter.assumptions}</p>
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
                                        <div className="bg-gray-50 p-4 rounded">
                                            <h4 className="text-sm font-semibold text-gray-700">Gerente do Projeto</h4>
                                            <p className="text-gray-600">{projectCharter.projectManager}</p>
                                        </div>
                                        <div className="bg-gray-50 p-4 rounded">
                                            <h4 className="text-sm font-semibold text-gray-700">Patrocinador</h4>
                                            <p className="text-gray-600">{projectCharter.sponsor}</p>
                                        </div>
                                        <div className="bg-gray-50 p-4 rounded">
                                            <h4 className="text-sm font-semibold text-gray-700">Data de Aprovação</h4>
                                            <p className="text-gray-600">{projectCharter.approvalDate}</p>
                                        </div>
                                    </div>
                                </div>
                            ) : (
                                <div className="text-center py-12">
                                    <i data-lucide="file-text" className="w-12 h-12 text-gray-300 mx-auto mb-3"></i>
                                    <p className="text-gray-500">Nenhum charter criado para este projeto</p>
                                    <p className="text-sm text-gray-400 mt-1">Clique no botão acima para criar o Project Charter</p>
                                </div>
                            )}
                        </div>

                        {/* Modal de Charter */}
                        {showModal === 'charter' && (
                            <CharterModal
                                charter={projectCharter}
                                projectId={activeProject?.id}
                                onSave={handleSaveCharter}
                                onClose={() => setShowModal(null)}
                            />
                        )}
                    </div>
                );
            };

            // Modal do Project Charter
            const CharterModal = ({ charter, projectId, onSave, onClose }) => {
                const [formData, setFormData] = useState(charter || {
                    projectId: projectId,
                    justification: '',
                    objectives: '',
                    highLevelScope: '',
                    keyDeliverables: '',
                    highLevelRisks: '',
                    assumptions: '',
                    projectManager: '',
                    sponsor: '',
                    approvalDate: ''
                });

                const handleSubmit = (e) => {
                    e.preventDefault();
                    onSave(formData);
                };

                return (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                        <div className="bg-white rounded-lg p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto">
                            <h3 className="text-xl font-bold mb-4">Project Charter</h3>
                            <form onSubmit={handleSubmit}>
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Justificativa do Projeto</label>
                                        <textarea
                                            className="w-full border rounded px-3 py-2"
                                            rows="3"
                                            required
                                            value={formData.justification}
                                            onChange={(e) => setFormData({...formData, justification: e.target.value})}
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Objetivos</label>
                                        <textarea
                                            className="w-full border rounded px-3 py-2"
                                            rows="3"
                                            required
                                            value={formData.objectives}
                                            onChange={(e) => setFormData({...formData, objectives: e.target.value})}
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Escopo de Alto Nível</label>
                                        <textarea
                                            className="w-full border rounded px-3 py-2"
                                            rows="3"
                                            required
                                            value={formData.highLevelScope}
                                            onChange={(e) => setFormData({...formData, highLevelScope: e.target.value})}
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Principais Entregas</label>
                                        <textarea
                                            className="w-full border rounded px-3 py-2"
                                            rows="3"
                                            required
                                            value={formData.keyDeliverables}
                                            onChange={(e) => setFormData({...formData, keyDeliverables: e.target.value})}
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Riscos de Alto Nível</label>
                                        <textarea
                                            className="w-full border rounded px-3 py-2"
                                            rows="3"
                                            required
                                            value={formData.highLevelRisks}
                                            onChange={(e) => setFormData({...formData, highLevelRisks: e.target.value})}
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Premissas e Restrições</label>
                                        <textarea
                                            className="w-full border rounded px-3 py-2"
                                            rows="3"
                                            required
                                            value={formData.assumptions}
                                            onChange={(e) => setFormData({...formData, assumptions: e.target.value})}
                                        />
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Gerente do Projeto</label>
                                            <input
                                                type="text"
                                                className="w-full border rounded px-3 py-2"
                                                required
                                                value={formData.projectManager}
                                                onChange={(e) => setFormData({...formData, projectManager: e.target.value})}
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Patrocinador</label>
                                            <input
                                                type="text"
                                                className="w-full border rounded px-3 py-2"
                                                required
                                                value={formData.sponsor}
                                                onChange={(e) => setFormData({...formData, sponsor: e.target.value})}
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Data de Aprovação</label>
                                            <input
                                                type="date"
                                                className="w-full border rounded px-3 py-2"
                                                required
                                                value={formData.approvalDate}
                                                onChange={(e) => setFormData({...formData, approvalDate: e.target.value})}
                                            />
                                        </div>
                                    </div>
                                </div>
                                <div className="flex justify-end gap-2 mt-6">
                                    <button
                                        type="button"
                                        onClick={onClose}
                                        className="px-4 py-2 border rounded hover:bg-gray-50"
                                    >
                                        Cancelar
                                    </button>
                                    <button
                                        type="submit"
                                        className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                                    >
                                        Salvar Charter
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                );
            };

            // Componente de Gestão de Stakeholders
            const StakeholdersView = () => {
                const projectStakeholders = stakeholders.filter(s => s.projectId === activeProject?.id);

                const handleSaveStakeholder = (stakeholder) => {
                    if (editingItem) {
                        setStakeholders(stakeholders.map(s => 
                            s.id === stakeholder.id ? stakeholder : s
                        ));
                    } else {
                        setStakeholders([...stakeholders, { ...stakeholder, id: Date.now() }]);
                    }
                    setShowModal(null);
                    setEditingItem(null);
                };

                const handleDeleteStakeholder = (id) => {
                    if (window.confirm('Deseja remover este stakeholder?')) {
                        setStakeholders(stakeholders.filter(s => s.id !== id));
                    }
                };

                const getInfluenceColor = (level) => {
                    switch(level) {
                        case 'high': return 'text-red-600 bg-red-50';
                        case 'medium': return 'text-yellow-600 bg-yellow-50';
                        case 'low': return 'text-green-600 bg-green-50';
                        default: return 'text-gray-600 bg-gray-50';
                    }
                };

                const getEngagementIcon = (level) => {
                    switch(level) {
                        case 'high': return 'user-check';
                        case 'medium': return 'user';
                        case 'low': return 'user-minus';
                        default: return 'user';
                    }
                };

                return (
                    <div className="space-y-6">
                        <div className="bg-white rounded-lg shadow">
                            <div className="p-6 border-b">
                                <div className="flex items-center justify-between">
                                    <h2 className="text-2xl font-bold text-gray-900">Gestão de Stakeholders</h2>
                                    <button
                                        onClick={() => setShowModal('stakeholder')}
                                        className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center gap-2"
                                    >
                                        <i data-lucide="user-plus" className="w-4 h-4"></i>
                                        Adicionar Stakeholder
                                    </button>
                                </div>
                            </div>

                            <div className="p-6">
                                {/* Matriz de Poder/Interesse */}
                                <div className="mb-6">
                                    <h3 className="text-lg font-semibold mb-4">Matriz Poder/Interesse</h3>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div className="bg-green-50 p-4 rounded">
                                            <h4 className="font-medium text-green-800 mb-2">Gerenciar de Perto</h4>
                                            <p className="text-sm text-green-600">Alto Poder + Alto Interesse</p>
                                            <div className="mt-2">
                                                {projectStakeholders.filter(s => s.power === 'high' && s.interest === 'high').map(s => (
                                                    <span key={s.id} className="inline-block px-2 py-1 bg-white rounded text-xs mr-1 mb-1">{s.name}</span>
                                                ))}
                                            </div>
                                        </div>
                                        <div className="bg-yellow-50 p-4 rounded">
                                            <h4 className="font-medium text-yellow-800 mb-2">Manter Satisfeito</h4>
                                            <p className="text-sm text-yellow-600">Alto Poder + Baixo Interesse</p>
                                            <div className="mt-2">
                                                {projectStakeholders.filter(s => s.power === 'high' && s.interest === 'low').map(s => (
                                                    <span key={s.id} className="inline-block px-2 py-1 bg-white rounded text-xs mr-1 mb-1">{s.name}</span>
                                                ))}
                                            </div>
                                        </div>
                                        <div className="bg-blue-50 p-4 rounded">
                                            <h4 className="font-medium text-blue-800 mb-2">Manter Informado</h4>
                                            <p className="text-sm text-blue-600">Baixo Poder + Alto Interesse</p>
                                            <div className="mt-2">
                                                {projectStakeholders.filter(s => s.power === 'low' && s.interest === 'high').map(s => (
                                                    <span key={s.id} className="inline-block px-2 py-1 bg-white rounded text-xs mr-1 mb-1">{s.name}</span>
                                                ))}
                                            </div>
                                        </div>
                                        <div className="bg-gray-50 p-4 rounded">
                                            <h4 className="font-medium text-gray-800 mb-2">Monitorar</h4>
                                            <p className="text-sm text-gray-600">Baixo Poder + Baixo Interesse</p>
                                            <div className="mt-2">
                                                {projectStakeholders.filter(s => s.power === 'low' && s.interest === 'low').map(s => (
                                                    <span key={s.id} className="inline-block px-2 py-1 bg-white rounded text-xs mr-1 mb-1">{s.name}</span>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Lista de Stakeholders */}
                                <h3 className="text-lg font-semibold mb-4">Registro de Stakeholders</h3>
                                {projectStakeholders.length > 0 ? (
                                    <div className="overflow-x-auto">
                                        <table className="min-w-full divide-y divide-gray-200">
                                            <thead className="bg-gray-50">
                                                <tr>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Papel</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Influência</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Engajamento</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estratégia</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                                </tr>
                                            </thead>
                                            <tbody className="bg-white divide-y divide-gray-200">
                                                {projectStakeholders.map(stakeholder => (
                                                    <tr key={stakeholder.id}>
                                                        <td className="px-6 py-4 whitespace-nowrap">
                                                            <div>
                                                                <div className="text-sm font-medium text-gray-900">{stakeholder.name}</div>
                                                                <div className="text-sm text-gray-500">{stakeholder.organization}</div>
                                                            </div>
                                                        </td>
                                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                            {stakeholder.role}
                                                        </td>
                                                        <td className="px-6 py-4 whitespace-nowrap">
                                                            <span className={`px-2 py-1 text-xs rounded-full ${getInfluenceColor(stakeholder.influence)}`}>
                                                                {stakeholder.influence === 'high' ? 'Alta' : 
                                                                 stakeholder.influence === 'medium' ? 'Média' : 'Baixa'}
                                                            </span>
                                                        </td>
                                                        <td className="px-6 py-4 whitespace-nowrap">
                                                            <i data-lucide={getEngagementIcon(stakeholder.engagement)} 
                                                               className={`w-5 h-5 ${
                                                                   stakeholder.engagement === 'high' ? 'text-green-500' :
                                                                   stakeholder.engagement === 'medium' ? 'text-yellow-500' :
                                                                   'text-red-500'
                                                               }`}></i>
                                                        </td>
                                                        <td className="px-6 py-4 text-sm text-gray-500">
                                                            {stakeholder.strategy}
                                                        </td>
                                                        <td className="px-6 py-4 whitespace-nowrap text-sm">
                                                            <button
                                                                onClick={() => {
                                                                    setEditingItem(stakeholder);
                                                                    setShowModal('stakeholder');
                                                                }}
                                                                className="text-blue-600 hover:text-blue-900 mr-2"
                                                            >
                                                                <i data-lucide="edit-2" className="w-4 h-4"></i>
                                                            </button>
                                                            <button
                                                                onClick={() => handleDeleteStakeholder(stakeholder.id)}
                                                                className="text-red-600 hover:text-red-900"
                                                            >
                                                                <i data-lucide="trash-2" className="w-4 h-4"></i>
                                                            </button>
                                                        </td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                ) : (
                                    <div className="text-center py-12">
                                        <i data-lucide="users" className="w-12 h-12 text-gray-300 mx-auto mb-3"></i>
                                        <p className="text-gray-500">Nenhum stakeholder registrado</p>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Modal de Stakeholder */}
                        {showModal === 'stakeholder' && (
                            <StakeholderModal
                                stakeholder={editingItem}
                                projectId={activeProject?.id}
                                onSave={handleSaveStakeholder}
                                onClose={() => {
                                    setShowModal(null);
                                    setEditingItem(null);
                                }}
                            />
                        )}
                    </div>
                );
            };

            // Modal de Stakeholder
            const StakeholderModal = ({ stakeholder, projectId, onSave, onClose }) => {
                const [formData, setFormData] = useState(stakeholder || {
                    projectId: projectId,
                    name: '',
                    organization: '',
                    role: '',
                    influence: 'medium',
                    interest: 'medium',
                    power: 'medium',
                    engagement: 'medium',
                    strategy: '',
                    expectations: '',
                    concerns: ''
                });

                const handleSubmit = (e) => {
                    e.preventDefault();
                    onSave(formData);
                };

                return (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                        <div className="bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                            <h3 className="text-xl font-bold mb-4">
                                {stakeholder ? 'Editar Stakeholder' : 'Adicionar Stakeholder'}
                            </h3>
                            <form onSubmit={handleSubmit}>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Nome</label>
                                        <input
                                            type="text"
                                            className="w-full border rounded px-3 py-2"
                                            required
                                            value={formData.name}
                                            onChange={(e) => setFormData({...formData, name: e.target.value})}
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Organização</label>
                                        <input
                                            type="text"
                                            className="w-full border rounded px-3 py-2"
                                            value={formData.organization}
                                            onChange={(e) => setFormData({...formData, organization: e.target.value})}
                                        />
                                    </div>
                                    <div className="md:col-span-2">
                                        <label className="block text-sm font-medium mb-1">Papel/Função</label>
                                        <input
                                            type="text"
                                            className="w-full border rounded px-3 py-2"
                                            required
                                            value={formData.role}
                                            onChange={(e) => setFormData({...formData, role: e.target.value})}
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Influência</label>
                                        <select
                                            className="w-full border rounded px-3 py-2"
                                            value={formData.influence}
                                            onChange={(e) => setFormData({...formData, influence: e.target.value})}
                                        >
                                            <option value="low">Baixa</option>
                                            <option value="medium">Média</option>
                                            <option value="high">Alta</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Interesse</label>
                                        <select
                                            className="w-full border rounded px-3 py-2"
                                            value={formData.interest}
                                            onChange={(e) => setFormData({...formData, interest: e.target.value})}
                                        >
                                            <option value="low">Baixo</option>
                                            <option value="medium">Médio</option>
                                            <option value="high">Alto</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Poder</label>
                                        <select
                                            className="w-full border rounded px-3 py-2"
                                            value={formData.power}
                                            onChange={(e) => setFormData({...formData, power: e.target.value})}
                                        >
                                            <option value="low">Baixo</option>
                                            <option value="medium">Médio</option>
                                            <option value="high">Alto</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Nível de Engajamento</label>
                                        <select
                                            className="w-full border rounded px-3 py-2"
                                            value={formData.engagement}
                                            onChange={(e) => setFormData({...formData, engagement: e.target.value})}
                                        >
                                            <option value="low">Baixo</option>
                                            <option value="medium">Médio</option>
                                            <option value="high">Alto</option>
                                        </select>
                                    </div>
                                    <div className="md:col-span-2">
                                        <label className="block text-sm font-medium mb-1">Estratégia de Engajamento</label>
                                        <textarea
                                            className="w-full border rounded px-3 py-2"
                                            rows="2"
                                            value={formData.strategy}
                                            onChange={(e) => setFormData({...formData, strategy: e.target.value})}
                                        />
                                    </div>
                                    <div className="md:col-span-2">
                                        <label className="block text-sm font-medium mb-1">Expectativas</label>
                                        <textarea
                                            className="w-full border rounded px-3 py-2"
                                            rows="2"
                                            value={formData.expectations}
                                            onChange={(e) => setFormData({...formData, expectations: e.target.value})}
                                        />
                                    </div>
                                    <div className="md:col-span-2">
                                        <label className="block text-sm font-medium mb-1">Preocupações</label>
                                        <textarea
                                            className="w-full border rounded px-3 py-2"
                                            rows="2"
                                            value={formData.concerns}
                                            onChange={(e) => setFormData({...formData, concerns: e.target.value})}
                                        />
                                    </div>
                                </div>
                                <div className="flex justify-end gap-2 mt-6">
                                    <button
                                        type="button"
                                        onClick={onClose}
                                        className="px-4 py-2 border rounded hover:bg-gray-50"
                                    >
                                        Cancelar
                                    </button>
                                    <button
                                        type="submit"
                                        className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                                    >
                                        Salvar
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                );
            };

            // Componente de Gestão de Riscos
            const RisksView = () => {
                const projectRisks = risks.filter(r => r.projectId === activeProject?.id);

                const handleSaveRisk = (risk) => {
                    if (editingItem) {
                        setRisks(risks.map(r => 
                            r.id === risk.id ? risk : r
                        ));
                    } else {
                        setRisks([...risks, { ...risk, id: Date.now() }]);
                    }
                    setShowModal(null);
                    setEditingItem(null);
                };

                const handleDeleteRisk = (id) => {
                    if (window.confirm('Deseja remover este risco?')) {
                        setRisks(risks.filter(r => r.id !== id));
                    }
                };

                const getRiskScore = (probability, impact) => {
                    const probValue = probability === 'high' ? 3 : probability === 'medium' ? 2 : 1;
                    const impactValue = impact === 'high' ? 3 : impact === 'medium' ? 2 : 1;
                    return probValue * impactValue;
                };

                const getRiskColor = (score) => {
                    if (score >= 6) return 'bg-red-100 text-red-800';
                    if (score >= 3) return 'bg-yellow-100 text-yellow-800';
                    return 'bg-green-100 text-green-800';
                };

                return (
                    <div className="space-y-6">
                        <div className="bg-white rounded-lg shadow">
                            <div className="p-6 border-b">
                                <div className="flex items-center justify-between">
                                    <h2 className="text-2xl font-bold text-gray-900">Registro de Riscos</h2>
                                    <button
                                        onClick={() => setShowModal('risk')}
                                        className="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 flex items-center gap-2"
                                    >
                                        <i data-lucide="alert-triangle" className="w-4 h-4"></i>
                                        Adicionar Risco
                                    </button>
                                </div>
                            </div>

                            <div className="p-6">
                                {/* Matriz de Probabilidade x Impacto */}
                                <div className="mb-6">
                                    <h3 className="text-lg font-semibold mb-4">Matriz de Probabilidade x Impacto</h3>
                                    <div className="grid grid-cols-4 gap-2">
                                        <div></div>
                                        <div className="text-center text-sm font-medium">Baixo</div>
                                        <div className="text-center text-sm font-medium">Médio</div>
                                        <div className="text-center text-sm font-medium">Alto</div>
                                        
                                        <div className="text-sm font-medium">Alta</div>
                                        <div className="bg-yellow-100 p-2 rounded text-center">
                                            <span className="text-xs">
                                                {projectRisks.filter(r => r.probability === 'high' && r.impact === 'low').length}
                                            </span>
                                        </div>
                                        <div className="bg-orange-100 p-2 rounded text-center">
                                            <span className="text-xs">
                                                {projectRisks.filter(r => r.probability === 'high' && r.impact === 'medium').length}
                                            </span>
                                        </div>
                                        <div className="bg-red-100 p-2 rounded text-center">
                                            <span className="text-xs">
                                                {projectRisks.filter(r => r.probability === 'high' && r.impact === 'high').length}
                                            </span>
                                        </div>

                                        <div className="text-sm font-medium">Média</div>
                                        <div className="bg-green-100 p-2 rounded text-center">
                                            <span className="text-xs">
                                                {projectRisks.filter(r => r.probability === 'medium' && r.impact === 'low').length}
                                            </span>
                                        </div>
                                        <div className="bg-yellow-100 p-2 rounded text-center">
                                            <span className="text-xs">
                                                {projectRisks.filter(r => r.probability === 'medium' && r.impact === 'medium').length}
                                            </span>
                                        </div>
                                        <div className="bg-orange-100 p-2 rounded text-center">
                                            <span className="text-xs">
                                                {projectRisks.filter(r => r.probability === 'medium' && r.impact === 'high').length}
                                            </span>
                                        </div>

                                        <div className="text-sm font-medium">Baixa</div>
                                        <div className="bg-green-50 p-2 rounded text-center">
                                            <span className="text-xs">
                                                {projectRisks.filter(r => r.probability === 'low' && r.impact === 'low').length}
                                            </span>
                                        </div>
                                        <div className="bg-green-100 p-2 rounded text-center">
                                            <span className="text-xs">
                                                {projectRisks.filter(r => r.probability === 'low' && r.impact === 'medium').length}
                                            </span>
                                        </div>
                                        <div className="bg-yellow-100 p-2 rounded text-center">
                                            <span className="text-xs">
                                                {projectRisks.filter(r => r.probability === 'low' && r.impact === 'high').length}
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                {/* Lista de Riscos */}
                                {projectRisks.length > 0 ? (
                                    <div className="overflow-x-auto">
                                        <table className="min-w-full divide-y divide-gray-200">
                                            <thead className="bg-gray-50">
                                                <tr>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descrição</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Categoria</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Probabilidade</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Impacto</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Score</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                                </tr>
                                            </thead>
                                            <tbody className="bg-white divide-y divide-gray-200">
                                                {projectRisks.map((risk, index) => {
                                                    const score = getRiskScore(risk.probability, risk.impact);
                                                    return (
                                                        <tr key={risk.id}>
                                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                                                                R{String(index + 1).padStart(3, '0')}
                                                            </td>
                                                            <td className="px-6 py-4">
                                                                <div>
                                                                    <div className="text-sm font-medium text-gray-900">{risk.description}</div>
                                                                    {risk.mitigation && (
                                                                        <div className="text-sm text-gray-500">Mitigação: {risk.mitigation}</div>
                                                                    )}
                                                                </div>
                                                            </td>
                                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                                {risk.category}
                                                            </td>
                                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                                {risk.probability === 'high' ? 'Alta' : 
                                                                 risk.probability === 'medium' ? 'Média' : 'Baixa'}
                                                            </td>
                                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                                                {risk.impact === 'high' ? 'Alto' : 
                                                                 risk.impact === 'medium' ? 'Médio' : 'Baixo'}
                                                            </td>
                                                            <td className="px-6 py-4 whitespace-nowrap">
                                                                <span className={`px-2 py-1 text-xs rounded-full ${getRiskColor(score)}`}>
                                                                    {score}
                                                                </span>
                                                            </td>
                                                            <td className="px-6 py-4 whitespace-nowrap">
                                                                <span className={`px-2 py-1 text-xs rounded-full ${
                                                                    risk.status === 'open' ? 'bg-yellow-100 text-yellow-800' :
                                                                    risk.status === 'mitigated' ? 'bg-green-100 text-green-800' :
                                                                    'bg-gray-100 text-gray-800'
                                                                }`}>
                                                                    {risk.status === 'open' ? 'Aberto' :
                                                                     risk.status === 'mitigated' ? 'Mitigado' :
                                                                     'Fechado'}
                                                                </span>
                                                            </td>
                                                            <td className="px-6 py-4 whitespace-nowrap text-sm">
                                                                <button
                                                                    onClick={() => {
                                                                        setEditingItem(risk);
                                                                        setShowModal('risk');
                                                                    }}
                                                                    className="text-blue-600 hover:text-blue-900 mr-2"
                                                                >
                                                                    <i data-lucide="edit-2" className="w-4 h-4"></i>
                                                                </button>
                                                                <button
                                                                    onClick={() => handleDeleteRisk(risk.id)}
                                                                    className="text-red-600 hover:text-red-900"
                                                                >
                                                                    <i data-lucide="trash-2" className="w-4 h-4"></i>
                                                                </button>
                                                            </td>
                                                        </tr>
                                                    );
                                                })}
                                            </tbody>
                                        </table>
                                    </div>
                                ) : (
                                    <div className="text-center py-12">
                                        <i data-lucide="shield" className="w-12 h-12 text-gray-300 mx-auto mb-3"></i>
                                        <p className="text-gray-500">Nenhum risco identificado</p>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Modal de Risco */}
                        {showModal === 'risk' && (
                            <RiskModal
                                risk={editingItem}
                                projectId={activeProject?.id}
                                onSave={handleSaveRisk}
                                onClose={() => {
                                    setShowModal(null);
                                    setEditingItem(null);
                                }}
                            />
                        )}
                    </div>
                );
            };

            // Modal de Risco
            const RiskModal = ({ risk, projectId, onSave, onClose }) => {
                const [formData, setFormData] = useState(risk || {
                    projectId: projectId,
                    description: '',
                    category: 'technical',
                    probability: 'medium',
                    impact: 'medium',
                    status: 'open',
                    owner: '',
                    mitigation: '',
                    contingency: '',
                    trigger: ''
                });

                const handleSubmit = (e) => {
                    e.preventDefault();
                    onSave(formData);
                };

                return (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                        <div className="bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                            <h3 className="text-xl font-bold mb-4">
                                {risk ? 'Editar Risco' : 'Adicionar Risco'}
                            </h3>
                            <form onSubmit={handleSubmit}>
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Descrição do Risco</label>
                                        <textarea
                                            className="w-full border rounded px-3 py-2"
                                            rows="2"
                                            required
                                            value={formData.description}
                                            onChange={(e) => setFormData({...formData, description: e.target.value})}
                                        />
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Categoria</label>
                                            <select
                                                className="w-full border rounded px-3 py-2"
                                                value={formData.category}
                                                onChange={(e) => setFormData({...formData, category: e.target.value})}
                                            >
                                                <option value="technical">Técnico</option>
                                                <option value="external">Externo</option>
                                                <option value="organizational">Organizacional</option>
                                                <option value="project-management">Gerenciamento de Projeto</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Responsável</label>
                                            <input
                                                type="text"
                                                className="w-full border rounded px-3 py-2"
                                                value={formData.owner}
                                                onChange={(e) => setFormData({...formData, owner: e.target.value})}
                                            />
                                        </div>
                                    </div>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Probabilidade</label>
                                            <select
                                                className="w-full border rounded px-3 py-2"
                                                value={formData.probability}
                                                onChange={(e) => setFormData({...formData, probability: e.target.value})}
                                            >
                                                <option value="low">Baixa</option>
                                                <option value="medium">Média</option>
                                                <option value="high">Alta</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Impacto</label>
                                            <select
                                                className="w-full border rounded px-3 py-2"
                                                value={formData.impact}
                                                onChange={(e) => setFormData({...formData, impact: e.target.value})}
                                            >
                                                <option value="low">Baixo</option>
                                                <option value="medium">Médio</option>
                                                <option value="high">Alto</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Status</label>
                                            <select
                                                className="w-full border rounded px-3 py-2"
                                                value={formData.status}
                                                onChange={(e) => setFormData({...formData, status: e.target.value})}
                                            >
                                                <option value="open">Aberto</option>
                                                <option value="mitigated">Mitigado</option>
                                                <option value="closed">Fechado</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Gatilho</label>
                                        <input
                                            type="text"
                                            className="w-full border rounded px-3 py-2"
                                            placeholder="Condição que indica que o risco está ocorrendo"
                                            value={formData.trigger}
                                            onChange={(e) => setFormData({...formData, trigger: e.target.value})}
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Estratégia de Mitigação</label>
                                        <textarea
                                            className="w-full border rounded px-3 py-2"
                                            rows="2"
                                            placeholder="Como prevenir ou reduzir a probabilidade/impacto"
                                            value={formData.mitigation}
                                            onChange={(e) => setFormData({...formData, mitigation: e.target.value})}
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Plano de Contingência</label>
                                        <textarea
                                            className="w-full border rounded px-3 py-2"
                                            rows="2"
                                            placeholder="O que fazer se o risco ocorrer"
                                            value={formData.contingency}
                                            onChange={(e) => setFormData({...formData, contingency: e.target.value})}
                                        />
                                    </div>
                                </div>
                                <div className="flex justify-end gap-2 mt-6">
                                    <button
                                        type="button"
                                        onClick={onClose}
                                        className="px-4 py-2 border rounded hover:bg-gray-50"
                                    >
                                        Cancelar
                                    </button>
                                    <button
                                        type="submit"
                                        className="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600"
                                    >
                                        Salvar Risco
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                );
            };

            // Modal de Projeto
            const ProjectModal = ({ project, onSave, onClose }) => {
                const [formData, setFormData] = useState(project || {
                    name: '',
                    description: '',
                    startDate: '',
                    endDate: '',
                    budget: '',
                    status: 'planning',
                    methodology: 'hybrid'
                });

                const handleSubmit = (e) => {
                    e.preventDefault();
                    onSave({ ...formData, id: project?.id || Date.now() });
                };

                return (
                    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                        <div className="bg-white rounded-lg p-6 w-full max-w-md">
                            <h3 className="text-xl font-bold mb-4">
                                {project ? 'Editar Projeto' : 'Novo Projeto'}
                            </h3>
                            <form onSubmit={handleSubmit}>
                                <div className="space-y-4">
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Nome do Projeto</label>
                                        <input
                                            type="text"
                                            className="w-full border rounded px-3 py-2"
                                            required
                                            value={formData.name}
                                            onChange={(e) => setFormData({...formData, name: e.target.value})}
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Descrição</label>
                                        <textarea
                                            className="w-full border rounded px-3 py-2"
                                            rows="3"
                                            value={formData.description}
                                            onChange={(e) => setFormData({...formData, description: e.target.value})}
                                        />
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Data Início</label>
                                            <input
                                                type="date"
                                                className="w-full border rounded px-3 py-2"
                                                value={formData.startDate}
                                                onChange={(e) => setFormData({...formData, startDate: e.target.value})}
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Data Fim</label>
                                            <input
                                                type="date"
                                                className="w-full border rounded px-3 py-2"
                                                value={formData.endDate}
                                                onChange={(e) => setFormData({...formData, endDate: e.target.value})}
                                            />
                                        </div>
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium mb-1">Orçamento</label>
                                        <input
                                            type="text"
                                            className="w-full border rounded px-3 py-2"
                                            placeholder="Ex: R$ 100.000,00"
                                            value={formData.budget}
                                            onChange={(e) => setFormData({...formData, budget: e.target.value})}
                                        />
                                    </div>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Status</label>
                                            <select
                                                className="w-full border rounded px-3 py-2"
                                                value={formData.status}
                                                onChange={(e) => setFormData({...formData, status: e.target.value})}
                                            >
                                                <option value="planning">Planejamento</option>
                                                <option value="active">Ativo</option>
                                                <option value="on-hold">Pausado</option>
                                                <option value="completed">Concluído</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-1">Metodologia</label>
                                            <select
                                                className="w-full border rounded px-3 py-2"
                                                value={formData.methodology}
                                                onChange={(e) => setFormData({...formData, methodology: e.target.value})}
                                            >
                                                <option value="waterfall">Cascata</option>
                                                <option value="agile">Ágil</option>
                                                <option value="hybrid">Híbrida</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div className="flex justify-end gap-2 mt-6">
                                    <button
                                        type="button"
                                        onClick={onClose}
                                        className="px-4 py-2 border rounded hover:bg-gray-50"
                                    >
                                        Cancelar
                                    </button>
                                    <button
                                        type="submit"
                                        className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                                    >
                                        Salvar
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                );
            };

            // Renderizar conteúdo principal baseado na view ativa
            const renderMainContent = () => {
                if (!activeProject && activeView !== 'dashboard') {
                    return (
                        <div className="flex items-center justify-center h-full">
                            <div className="text-center">
                                <i data-lucide="folder-open" className="w-16 h-16 text-gray-300 mx-auto mb-4"></i>
                                <h3 className="text-lg font-medium text-gray-900 mb-2">Nenhum projeto selecionado</h3>
                                <p className="text-gray-500">Selecione um projeto para acessar este recurso</p>
                            </div>
                        </div>
                    );
                }

                switch(activeView) {
                    case 'dashboard':
                        return <Dashboard />;
                    case 'charter':
                        return <ProjectCharter />;
                    case 'stakeholders':
                        return <StakeholdersView />;
                    case 'risks':
                        return <RisksView />;
                    default:
                        return (
                            <div className="bg-white rounded-lg shadow p-6">
                                <h2 className="text-2xl font-bold text-gray-900 mb-4">{activeView}</h2>
                                <p className="text-gray-500">Esta seção está em desenvolvimento...</p>
                            </div>
                        );
                }
            };

            // Inicializar ícones Lucide
            useEffect(() => {
                lucide.createIcons();
            });

            return (
                <div className="min-h-screen bg-gray-50 flex">
                    {/* Sidebar */}
                    <div className="w-64 bg-white shadow-lg">
                        <div className="p-4 border-b">
                            <h1 className="text-xl font-bold text-gray-900">PMBOK 7 Manager</h1>
                            <p className="text-xs text-gray-500 mt-1">Sistema de Gestão de Projetos</p>
                        </div>

                        {/* Seletor de Projeto */}
                        <div className="p-4 border-b">
                            <label className="block text-sm font-medium text-gray-700 mb-2">Projeto Ativo</label>
                            <select
                                className="w-full border rounded px-3 py-2 text-sm"
                                value={activeProject?.id || ''}
                                onChange={(e) => {
                                    const project = projects.find(p => p.id === parseInt(e.target.value));
                                    setActiveProject(project);
                                }}
                            >
                                <option value="">Selecione um projeto</option>
                                {projects.map(project => (
                                    <option key={project.id} value={project.id}>{project.name}</option>
                                ))}
                            </select>
                            <button
                                onClick={() => setShowModal('project')}
                                className="w-full mt-2 px-3 py-2 bg-blue-500 text-white rounded text-sm hover:bg-blue-600 flex items-center justify-center gap-2"
                            >
                                <i data-lucide="plus" className="w-4 h-4"></i>
                                Novo Projeto
                            </button>
                        </div>

                        {/* Menu de Navegação */}
                        <nav className="p-4">
                            <ul className="space-y-1">
                                {menuItems.map(item => (
                                    <li key={item.id}>
                                        <button
                                            onClick={() => setActiveView(item.id)}
                                            className={`w-full text-left px-3 py-2 rounded flex items-center gap-3 text-sm transition-colors ${
                                                activeView === item.id 
                                                    ? 'bg-blue-50 text-blue-600' 
                                                    : 'text-gray-700 hover:bg-gray-50'
                                            }`}
                                        >
                                            <i data-lucide={item.icon} className="w-4 h-4"></i>
                                            {item.name}
                                        </button>
                                    </li>
                                ))}
                            </ul>
                        </nav>

                        {/* Info PMBOK */}
                        <div className="p-4 border-t">
                            <div className="text-xs text-gray-500">
                                <p className="font-semibold mb-1">PMBOK® Guide</p>
                                <p>7ª Edição</p>
                                <p className="mt-2">12 Princípios</p>
                                <p>8 Domínios de Desempenho</p>
                            </div>
                        </div>
                    </div>

                    {/* Conteúdo Principal */}
                    <div className="flex-1 p-6 overflow-auto">
                        {renderMainContent()}
                    </div>

                    {/* Modal de Projeto */}
                    {showModal === 'project' && (
                        <ProjectModal
                            project={editingItem}
                            onSave={(project) => {
                                if (editingItem) {
                                    setProjects(projects.map(p => 
                                        p.id === project.id ? project : p
                                    ));
                                } else {
                                    setProjects([...projects, project]);
                                    setActiveProject(project);
                                }
                                setShowModal(null);
                                setEditingItem(null);
                            }}
                            onClose={() => {
                                setShowModal(null);
                                setEditingItem(null);
                            }}
                        />
                    )}
                </div>
            );
        };

        // Renderizar aplicação
        ReactDOM.createRoot(document.getElementById('root')).render(<PMBOKProjectManager />);
        
        // Atualizar ícones
        setTimeout(() => {
            lucide.createIcons();
        }, 100);
    </script>
</body>
</html>
